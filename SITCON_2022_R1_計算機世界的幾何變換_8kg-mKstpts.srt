1
00:00:00,000 --> 00:00:08,320
大家好，我是來自國立陽明交通大學應用數學所的廖家瑋

2
00:00:08,320 --> 00:00:13,120
今天是我以應用數學所最後一次的身分做演講

3
00:00:13,120 --> 00:00:16,320
明天我即將去台大資工去唸博士班

4
00:00:16,320 --> 00:00:21,920
我今天想演講的主題是關於計算機世界的幾何變換

5
00:00:21,920 --> 00:00:28,800
它其實會牽涉到影像處理、計算機圖學、電腦視覺相關的議題

6
00:00:28,880 --> 00:00:32,960
大家如果有興趣的話可以去到資工系去修這些的課程

7
00:00:32,960 --> 00:00:36,320
這個是我演講的大綱

8
00:00:36,320 --> 00:00:38,960
主要的話我會 focus 在這三個地方

9
00:00:38,960 --> 00:00:43,200
我會用三個例子來告訴大家說我們的幾何裡面

10
00:00:43,200 --> 00:00:45,360
幾何要怎麼用在計算機裡面

11
00:00:45,360 --> 00:00:49,120
第一個是我會講的就是二維影像評解

12
00:00:49,120 --> 00:00:52,880
接下來的話我會講可能大家有看過阿凡達

13
00:00:52,880 --> 00:00:55,760
我會講阿凡達的特效大概是怎麼製作出來的

14
00:00:56,000 --> 00:00:59,680
第三個的話我會講說我們一些幾何變換

15
00:00:59,680 --> 00:01:04,560
用在醫學影像上可以怎麼運用

16
00:01:04,560 --> 00:01:06,880
以下的東西會牽涉到很多數學

17
00:01:06,880 --> 00:01:10,400
所以可能大家看到數學會害怕

18
00:01:10,400 --> 00:01:13,040
如果可能產生頭暈或是不適的狀況

19
00:01:13,040 --> 00:01:14,400
就是請見諒這樣

20
00:01:14,400 --> 00:01:18,080
我會盡量把數學的成分壓低

21
00:01:18,080 --> 00:01:20,800
第一個的話我會講的是二維影像評解

22
00:01:20,800 --> 00:01:25,680
這二維影像評解主要是由我還有師大的一些同學

23
00:01:25,680 --> 00:01:30,480
還有老師在國家理論中心所完成的一個專題

24
00:01:30,480 --> 00:01:32,720
那什麼是影像評解問題呢

25
00:01:32,720 --> 00:01:35,600
大家可以想像的是影像評解

26
00:01:35,600 --> 00:01:38,080
我們現在看到的話這個東西不是影像評解

27
00:01:38,080 --> 00:01:39,600
這個東西比較像一個拼圖

28
00:01:39,600 --> 00:01:41,520
你今天很簡單就是把左邊的圖

29
00:01:41,520 --> 00:01:43,760
然後跟右邊的圖直接把它拼上去

30
00:01:43,760 --> 00:01:46,080
小學生都可以完成一個拼圖

31
00:01:46,080 --> 00:01:47,920
影像評解的話是這個樣子的

32
00:01:47,920 --> 00:01:51,200
因為我們在相機拍攝的時候可能因為角度的關係

33
00:01:51,200 --> 00:01:53,600
所以可能你拍出來的角度會有些差異

34
00:01:53,600 --> 00:01:55,040
然後有大有小

35
00:01:55,040 --> 00:01:57,520
所以我們需要透過某種幾何變換方式

36
00:01:57,520 --> 00:02:00,320
把某一張圖片投影到另外一張圖片上面

37
00:02:00,320 --> 00:02:01,840
然後把它拼接完成

38
00:02:01,840 --> 00:02:04,640
所以這個東西就是我們今天要完成的這個目標

39
00:02:08,960 --> 00:02:09,920
不好意思

40
00:02:12,000 --> 00:02:14,000
戴著口罩講有點累

41
00:02:14,000 --> 00:02:14,880
好

42
00:02:14,880 --> 00:02:19,120
那大家應該在可能在路上有看過這台車

43
00:02:19,120 --> 00:02:21,760
這台車是 Google 他們的街景車

44
00:02:21,760 --> 00:02:24,160
可能大家有時候在路上會看到

45
00:02:24,640 --> 00:02:28,720
那 Google 他們其實也有內建自己的影像拼接技術

46
00:02:28,720 --> 00:02:31,600
但是在早期的這個拼接的話可以看到說

47
00:02:31,600 --> 00:02:33,840
像這台車的話就出現殘影了

48
00:02:33,840 --> 00:02:35,440
然後這個橋突然斷掉了

49
00:02:35,440 --> 00:02:36,400
非常危險

50
00:02:36,400 --> 00:02:40,560
所以我們今天就是要講關於影像拼接的技術

51
00:02:41,600 --> 00:02:42,160
好

52
00:02:42,160 --> 00:02:48,640
那我們實驗的這個影像是拿台大天數館的四樓教室

53
00:02:48,640 --> 00:02:52,960
那我們想要讓我們的研究又有點挑戰性

54
00:02:52,960 --> 00:02:55,600
所以的話我們在白天的時候拍攝一張影像

55
00:02:55,600 --> 00:02:57,920
然後討論到晚上的時候又拍攝一張影像

56
00:02:57,920 --> 00:03:00,240
所以你會發現說這兩張影像明顯有色差

57
00:03:00,240 --> 00:03:03,840
所以它拼接出來其實有點困難

58
00:03:05,120 --> 00:03:05,600
好

59
00:03:05,600 --> 00:03:09,360
那影像拼接的話主要可以分成這五個步驟

60
00:03:09,360 --> 00:03:14,880
那前三個步驟的話是在資訊領域比較會常做到的

61
00:03:14,880 --> 00:03:18,160
那後面的這兩個是我們自己開發出來的一個

62
00:03:18,160 --> 00:03:20,880
算是新的一個比較新的算法

63
00:03:20,960 --> 00:03:23,840
好那前面這三個的話主要是由師大的黃金恩同學

64
00:03:23,840 --> 00:03:25,280
還有師大岳美恆教授

65
00:03:25,280 --> 00:03:27,920
他們在教育部的計畫有先完成

66
00:03:27,920 --> 00:03:29,440
好那待會的話我們會講到說

67
00:03:29,440 --> 00:03:30,720
我們的這個拼接的這個技術

68
00:03:30,720 --> 00:03:34,720
跟 Photoshop 它的拼接有什麼樣的差異

69
00:03:34,720 --> 00:03:35,120
好

70
00:03:35,120 --> 00:03:36,560
那其實在影像拼接的話

71
00:03:36,560 --> 00:03:39,920
第一個最重要的就是我們要找尋拼接的特徵點

72
00:03:39,920 --> 00:03:41,040
那什麼是特徵點呢

73
00:03:41,040 --> 00:03:42,720
大家可以想像說在一個班級裡面

74
00:03:42,720 --> 00:03:45,040
你可能要找到某些比較特殊的同學

75
00:03:45,040 --> 00:03:47,280
比方說這個同學他可能是身高最高的同學

76
00:03:47,280 --> 00:03:48,960
或是他體重特別重

77
00:03:49,040 --> 00:03:52,720
那同理這個影像拼接的這個特徵點是一樣的

78
00:03:52,720 --> 00:03:54,720
特徵點的話就是說這些影像裡面的

79
00:03:54,720 --> 00:03:57,440
它最特殊的一些點

80
00:03:57,440 --> 00:03:57,920
好

81
00:03:57,920 --> 00:04:00,640
那我們用到這個演算法叫 SIF 演算法

82
00:04:00,640 --> 00:04:02,640
那 SIF 演算法其實有點複雜

83
00:04:02,640 --> 00:04:04,960
所以大家有興趣的話可以去搜尋一下

84
00:04:04,960 --> 00:04:06,320
那我們主要講的概念就是說

85
00:04:06,320 --> 00:04:09,840
SIF 演算法它是用一個向量來描述這些特徵點

86
00:04:09,840 --> 00:04:11,920
就好像說你今天賦予這些特徵點

87
00:04:11,920 --> 00:04:13,680
它的身分證字號的感覺

88
00:04:13,680 --> 00:04:15,520
那待會我們就會利用這些身分證字號

89
00:04:15,520 --> 00:04:17,600
來幫我們做配對

90
00:04:17,600 --> 00:04:18,000
好

91
00:04:18,080 --> 00:04:20,480
那我們現在的話已經找到特徵點了

92
00:04:20,480 --> 00:04:23,440
那我們需要把這些特徵點做配對

93
00:04:23,440 --> 00:04:25,680
那我們是怎麼用來做配對的

94
00:04:25,680 --> 00:04:27,920
我們使用到的是這個 KN 的演算法

95
00:04:27,920 --> 00:04:29,360
那這個 KN 演算法的話

96
00:04:29,360 --> 00:04:33,040
它可以把左邊的圖跟右邊的圖特徵點做一個配對起來

97
00:04:33,040 --> 00:04:36,400
那就好像說今天你去找另一半的感覺

98
00:04:36,400 --> 00:04:36,800
好

99
00:04:36,800 --> 00:04:39,040
但是這個特徵點配對其實非常重要

100
00:04:39,040 --> 00:04:41,200
如果你今天特徵點配對不好的話

101
00:04:41,200 --> 00:04:43,200
那待會你拼接出來的東西就會像剛剛

102
00:04:43,200 --> 00:04:45,040
Google 他們拼接出來的效果一樣

103
00:04:45,040 --> 00:04:48,880
就是可能會有一些殘差的感覺

104
00:04:48,880 --> 00:04:51,600
那就好像說你今天如果你找錯另一半了

105
00:04:51,600 --> 00:04:52,720
那你的婚姻可能會很慘

106
00:04:52,720 --> 00:04:55,040
好

107
00:04:55,040 --> 00:04:57,040
那我們現在如果找到特點之後

108
00:04:57,040 --> 00:04:59,280
我們現在就必須要把它做投影上去

109
00:04:59,280 --> 00:05:02,720
可能把一張影像投影到另外一張影像上

110
00:05:02,720 --> 00:05:05,840
那可能大家在高二的時候可能有學過一些幾何

111
00:05:05,840 --> 00:05:07,120
平面上的幾何變換

112
00:05:07,120 --> 00:05:10,720
舉凡像是旋轉啊伸縮啊平移啊等等的推移

113
00:05:10,720 --> 00:05:13,680
那這些東西都可以用矩陣的方式來表示出來

114
00:05:14,000 --> 00:05:17,440
好那這邊的話呢我們廣義來講這個東西叫做

115
00:05:17,440 --> 00:05:18,400
仿射變換

116
00:05:18,400 --> 00:05:21,120
那仿射變換的話呢它可以把一個四邊形呢

117
00:05:21,120 --> 00:05:24,000
做一個變換變換到一個平移四邊形上

118
00:05:24,000 --> 00:05:28,400
好那它的矩陣表示式就是下面這個

119
00:05:28,400 --> 00:05:30,560
好但這個仿射變換的話呢它

120
00:05:30,560 --> 00:05:33,280
僅能把它變換成一個平移四邊形

121
00:05:33,280 --> 00:05:35,760
假設說如果我今天想要把它變換成一個 T 型的話

122
00:05:35,760 --> 00:05:38,720
我們就要引入一個叫其次座標的投影變換

123
00:05:38,720 --> 00:05:41,200
那這個投影變換的話可能大家會發現說

124
00:05:41,200 --> 00:05:43,440
它其實多了一個第三個維度

125
00:05:43,440 --> 00:05:44,480
下面都有個 1

126
00:05:44,480 --> 00:05:46,320
這個東西我們叫做其次座標

127
00:05:46,320 --> 00:05:48,480
那因為這個東西其實蠻複雜的

128
00:05:48,480 --> 00:05:51,040
大家只要知道說我們在做投影變換的時候

129
00:05:51,040 --> 00:05:53,440
它的這個變數呢會比仿射變換多

130
00:05:53,440 --> 00:05:55,040
所以代表說它能表示的東西呢

131
00:05:55,040 --> 00:05:57,520
是可以比仿射變換來得更多的

132
00:05:57,520 --> 00:05:59,840
那我們待會就使用到這個投影變換

133
00:05:59,840 --> 00:06:01,440
來投影我們的影像

134
00:06:01,440 --> 00:06:03,520
好那我們現在來看一下就是

135
00:06:03,520 --> 00:06:06,080
這邊的話呢是我們原始的兩張影像

136
00:06:06,080 --> 00:06:08,240
那我們經過投影變換之後的話呢

137
00:06:08,240 --> 00:06:10,880
就可以把它投影到一個 T 型上面

138
00:06:10,960 --> 00:06:13,760
好那接下來的話呢我們就是要把它拼起來

139
00:06:16,640 --> 00:06:20,240
好那如果你直接把它拼起來的話當然可以的

140
00:06:20,240 --> 00:06:23,120
那我們發現說拼起來的話拼接觸到底要

141
00:06:23,120 --> 00:06:25,680
使用第一張影像還是使用第二張影像

142
00:06:25,680 --> 00:06:26,960
那這樣呢看起來有點

143
00:06:26,960 --> 00:06:28,880
你使用哪張影像都有點不公平

144
00:06:28,880 --> 00:06:32,080
所以我們就希望說我們可以把它做得比較漂亮一點

145
00:06:32,880 --> 00:06:36,080
好那呢我們引入了一個叫做遮罩的東西

146
00:06:36,080 --> 00:06:38,640
那這個遮罩的話呢可以把它想像成是一種

147
00:06:38,640 --> 00:06:39,680
平均的概念

148
00:06:39,680 --> 00:06:42,560
我們呢我們先來看這個效果

149
00:06:42,560 --> 00:06:44,640
這邊的話呢我們有數學式可以看到說

150
00:06:44,640 --> 00:06:47,680
我們是把第一張影像跟第二張影像

151
00:06:47,680 --> 00:06:50,800
做了一個加權平均來表示它的中間部分

152
00:06:50,800 --> 00:06:54,240
那我們可以發現說以這個 w 來講好了

153
00:06:54,240 --> 00:06:57,600
它靠近 i1 的時候呢它這個值呢是比較大的是 1

154
00:06:57,600 --> 00:07:01,440
然後呢在靠近 i2 的時候它的值呢是最小的是 0

155
00:07:01,440 --> 00:07:05,440
所以代表說這個 w 它大小它會是一個連續的變換

156
00:07:05,440 --> 00:07:08,320
連續變換的話就是說它從 1 慢慢變換到 0

157
00:07:08,400 --> 00:07:10,800
那你可以看到是說這樣拼接起來的話

158
00:07:10,800 --> 00:07:12,640
大概會有一些不錯的效果

159
00:07:12,640 --> 00:07:15,840
可是我們發現說在邊界的地方可能會有一些殘影

160
00:07:15,840 --> 00:07:19,120
像這裡

161
00:07:19,120 --> 00:07:20,880
這裡的話可能會有一些影子在

162
00:07:20,880 --> 00:07:22,800
那我們要如何消除這些影子呢

163
00:07:22,800 --> 00:07:25,120
所以這裡的話我們就去思考說

164
00:07:25,120 --> 00:07:29,520
我們要怎麼讓它的這個遮罩變得更平滑一點

165
00:07:29,520 --> 00:07:32,320
那這邊的話我們引入了一些比較可怕的數學

166
00:07:32,320 --> 00:07:34,320
那這個數學的話大家可以想像是

167
00:07:34,320 --> 00:07:38,000
我們希望的話是邊界的話一樣維持剛剛這邊是 1

168
00:07:38,000 --> 00:07:39,040
然後這邊是 0 這樣

169
00:07:39,040 --> 00:07:40,800
那內部要比較平滑一點

170
00:07:40,800 --> 00:07:42,800
那怎麼讓它變得平滑一點呢

171
00:07:42,800 --> 00:07:44,640
大家如果有學過微積分的話

172
00:07:44,640 --> 00:07:48,000
這邊的話這個叫做一個叫 Laprochian 的一個算子

173
00:07:48,000 --> 00:07:50,160
就是你把它對 S 偏為兩次

174
00:07:50,160 --> 00:07:51,680
然後把它對 Y 偏為兩次

175
00:07:51,680 --> 00:07:52,880
然後令它的 0

176
00:07:52,880 --> 00:07:54,720
這個東西就是代表這個符號

177
00:07:54,720 --> 00:07:56,720
那大家只要知道說這個東西

178
00:07:56,720 --> 00:07:58,640
可以讓它內部變得比較平滑一點

179
00:07:58,640 --> 00:08:00,560
所以我們使用了這個方式之後

180
00:08:00,560 --> 00:08:02,320
然後接下來它的拼接效果

181
00:08:02,320 --> 00:08:05,440
就可以讓我們邊界的殘影給消除掉

182
00:08:05,440 --> 00:08:09,280
所以目前的話我們就可以得到一張完美的影像

183
00:08:09,280 --> 00:08:12,720
但是你再看一下發現說

184
00:08:12,720 --> 00:08:15,360
這張影像它那個形狀有點怪怪的

185
00:08:15,360 --> 00:08:17,680
它這邊上面黑黑的然後下面黑黑的

186
00:08:17,680 --> 00:08:19,920
所以的話比較直接的辦法就是說

187
00:08:19,920 --> 00:08:21,360
我們可以把它直接裁掉

188
00:08:21,360 --> 00:08:23,200
那直接裁掉的辦法的話

189
00:08:23,200 --> 00:08:25,680
就可以變成是像是右邊這樣影像

190
00:08:25,680 --> 00:08:28,640
可是假如說如果你今天很喜歡女生坐在這裡的話

191
00:08:28,640 --> 00:08:30,480
你直接把它裁掉你就看不到它了

192
00:08:30,480 --> 00:08:31,440
這有點可惜

193
00:08:31,440 --> 00:08:32,480
所以我們想辦法說

194
00:08:32,480 --> 00:08:34,560
看能不能直接用其他數學方式

195
00:08:34,560 --> 00:08:38,400
把它讓所有的這些邊角不要浪費掉

196
00:08:38,400 --> 00:08:40,640
好所以考慮到一個方式就是叫做

197
00:08:40,640 --> 00:08:42,000
保角攤平的方式

198
00:08:42,000 --> 00:08:43,440
那什麼是保角攤平呢

199
00:08:43,440 --> 00:08:45,280
就是說我們把邊界上的這些

200
00:08:45,280 --> 00:08:47,200
邊界上這一點以及邊

201
00:08:47,200 --> 00:08:50,320
然後把它打到這邊的一個長方形上

202
00:08:50,320 --> 00:08:53,600
然後內部的話我們使用一個函數的方式把它攤開來

203
00:08:53,600 --> 00:08:54,800
就可以變成這個樣子

204
00:08:54,800 --> 00:08:57,760
好那我們使用到這個數學方式的話

205
00:08:57,760 --> 00:09:00,320
它其實會保持說你這影像的這些角度

206
00:09:00,320 --> 00:09:01,360
Sorry

207
00:09:01,360 --> 00:09:03,920
它會保持說你這影像的這些角度之序

208
00:09:04,000 --> 00:09:05,920
它就不會說你原本在這邊

209
00:09:05,920 --> 00:09:08,000
然後到這邊的話它的那個形變很大

210
00:09:08,000 --> 00:09:09,120
如果形變很大的話

211
00:09:09,120 --> 00:09:12,240
這樣的話你東西物體就會變得很奇怪這樣

212
00:09:12,240 --> 00:09:16,480
好所以的話這就是我們使用的這個保角攤平

213
00:09:16,480 --> 00:09:18,480
好那接下來的話我們就來比較說

214
00:09:18,480 --> 00:09:21,520
我們市面上的這些 Photoshop 它的這個

215
00:09:21,520 --> 00:09:23,680
大概速度大概多快

216
00:09:23,680 --> 00:09:26,880
好首先的話如果我們今天考慮一到四的話

217
00:09:26,880 --> 00:09:29,120
如果使用連續型遮罩的話以及裁切

218
00:09:29,120 --> 00:09:31,280
我們僅使用了兩秒鐘的速度

219
00:09:31,280 --> 00:09:33,840
那這邊主要是由黃堅同學所完成的

220
00:09:33,920 --> 00:09:35,520
好那 Photoshop 的話我們發現說

221
00:09:35,520 --> 00:09:38,160
它其實跑我們這個影像的話要跑 18 秒

222
00:09:38,160 --> 00:09:40,480
所以我們速度比它快了 9 倍

223
00:09:40,480 --> 00:09:41,600
好當然我們剛剛有提到說

224
00:09:41,600 --> 00:09:44,080
如果我們使用的是那個連續型遮罩的話

225
00:09:44,080 --> 00:09:46,080
那可能會有一些邊界或者殘影

226
00:09:46,080 --> 00:09:47,520
所以的話如果我們來看第三個

227
00:09:47,520 --> 00:09:50,000
就是我們考慮到了這個平滑型遮罩

228
00:09:50,000 --> 00:09:51,840
然後再把它做保角攤平的話

229
00:09:51,840 --> 00:09:54,160
我們這邊主要花了就是 14 秒左右

230
00:09:54,160 --> 00:09:55,040
那大家會想像說

231
00:09:55,040 --> 00:09:57,120
為什麼把這個連續型換成平滑型之後

232
00:09:57,120 --> 00:09:58,960
它的這個秒數變得非常多

233
00:09:58,960 --> 00:10:00,480
好那大家可以想像是說

234
00:10:00,480 --> 00:10:02,800
我們的影像在解這個影像問題的時候

235
00:10:02,800 --> 00:10:05,840
它對應到的是一個 1000 多萬維的矩陣

236
00:10:05,840 --> 00:10:06,960
那 1000 多萬維的話

237
00:10:06,960 --> 00:10:08,720
這個矩陣解起來非常的可怕

238
00:10:08,720 --> 00:10:09,840
我們用了一些數學手段

239
00:10:09,840 --> 00:10:11,760
才把它壓到就是 10 秒以內

240
00:10:11,760 --> 00:10:16,400
所以這個東西其實就會花非常久的時間

241
00:10:16,400 --> 00:10:18,960
好那講完剛剛影像拼接之後

242
00:10:18,960 --> 00:10:21,520
我們現在來講阿凡達的特效這個

243
00:10:21,520 --> 00:10:23,280
好那大家有看過阿凡達嗎

244
00:10:23,280 --> 00:10:26,080
阿凡達其實是在好幾年前

245
00:10:26,080 --> 00:10:27,680
所上映的一部電影這樣

246
00:10:27,680 --> 00:10:28,720
那在年底的時候

247
00:10:28,720 --> 00:10:31,280
其實好像會上映它的第二集

248
00:10:31,440 --> 00:10:32,400
好那我們就來講說

249
00:10:32,400 --> 00:10:35,040
阿凡達它的特效是怎麼辦到的

250
00:10:35,040 --> 00:10:37,360
那這個主要的話是由這個岳美恆教授

251
00:10:37,360 --> 00:10:41,200
他在這個機上工人集合所提及的一些教材

252
00:10:41,200 --> 00:10:43,360
那我們都知道說阿凡達他其實

253
00:10:43,360 --> 00:10:45,120
他在拍攝的時候他並不是說

254
00:10:45,120 --> 00:10:47,280
把每個演員的臉上去塗油漆

255
00:10:47,280 --> 00:10:50,480
他其實那些面具其實是後製上去的

256
00:10:50,480 --> 00:10:51,680
那我們今天就來看說

257
00:10:51,680 --> 00:10:53,680
這類似的這個面具該如何做

258
00:10:53,680 --> 00:10:56,480
做到人臉上面

259
00:10:56,480 --> 00:10:58,800
好那在講這個阿凡達之前

260
00:10:58,800 --> 00:11:00,400
我們先來看一下一個例子

261
00:11:00,480 --> 00:11:02,880
這個例子是關於這個地球還有地圖

262
00:11:02,880 --> 00:11:05,440
我們知道說這個地球是在一個

263
00:11:05,440 --> 00:11:06,960
三維空間中的一個曲面

264
00:11:06,960 --> 00:11:10,080
那我們投影的方式就可能有兩種方式

265
00:11:10,080 --> 00:11:11,760
第一種就是我們在高中所提及的

266
00:11:11,760 --> 00:11:14,400
這個叫做麥卡托投影

267
00:11:14,400 --> 00:11:16,560
好那這個麥卡托投影的話

268
00:11:16,560 --> 00:11:17,920
其實我們可以發現說

269
00:11:17,920 --> 00:11:20,480
它可以用來保持我們這些方位的資訊

270
00:11:20,480 --> 00:11:22,320
但是你看在高緯度的地方

271
00:11:22,320 --> 00:11:24,400
它這個面積實在非常嚴重

272
00:11:24,400 --> 00:11:25,840
我想對岸應該很希望說

273
00:11:25,840 --> 00:11:27,200
他們可以辦到高緯度區域

274
00:11:27,200 --> 00:11:30,000
這樣他們看起來國土面積會比較大一點

275
00:11:30,080 --> 00:11:32,880
好那第二種的話就是這個貝爾曼投影法

276
00:11:32,880 --> 00:11:33,840
那貝爾曼投影法的話

277
00:11:33,840 --> 00:11:35,920
它其實是保持的是面積資訊

278
00:11:35,920 --> 00:11:37,040
但是在高緯度的話

279
00:11:37,040 --> 00:11:40,400
它這個形狀就會失真的非常嚴重

280
00:11:40,400 --> 00:11:43,040
那為什麼我們會想要做這個投影呢

281
00:11:43,040 --> 00:11:43,920
第一個就是說

282
00:11:43,920 --> 00:11:46,320
你視覺上看起來會比較好看

283
00:11:46,320 --> 00:11:47,600
你要去看這個地球

284
00:11:47,600 --> 00:11:48,560
三維地球的話

285
00:11:48,560 --> 00:11:51,120
你可能要轉動一下比較麻煩

286
00:11:51,120 --> 00:11:52,080
第二個的話就是說

287
00:11:52,080 --> 00:11:53,920
你可以拿去定防衛

288
00:11:53,920 --> 00:11:55,040
定防衛的話

289
00:11:55,040 --> 00:11:57,760
我們在地球上其實應該說定座標

290
00:11:57,760 --> 00:11:59,120
我們要描述這個

291
00:11:59,120 --> 00:12:00,480
三維空間中的這個曲面的座標

292
00:12:00,480 --> 00:12:01,520
其實不太容易

293
00:12:01,520 --> 00:12:03,120
那如果我們把它攤開到二維上的話

294
00:12:03,120 --> 00:12:04,240
我們就可以用我們熟悉的

295
00:12:04,240 --> 00:12:07,440
這個笛卡爾的座標來描述它

296
00:12:07,440 --> 00:12:09,360
好那我們的人臉也是一樣的

297
00:12:09,360 --> 00:12:10,560
我們人臉的話呢

298
00:12:10,560 --> 00:12:12,480
今天在三維它是一個不規則的曲面

299
00:12:12,480 --> 00:12:14,000
它要比地球還更難了

300
00:12:14,000 --> 00:12:16,320
那我們希望說我們可以透過某種手段

301
00:12:16,320 --> 00:12:18,640
把它映射到一個二維圓盤上

302
00:12:18,640 --> 00:12:21,440
那這個函數的話可能是一個保角的

303
00:12:21,440 --> 00:12:24,720
就是有點像是地球的地圖上保持方位

304
00:12:24,720 --> 00:12:26,400
或是保面積的

305
00:12:26,400 --> 00:12:28,640
所以這是我們今天的目的

306
00:12:28,640 --> 00:12:32,560
好那待會就會說我們為什麼要做這件事情

307
00:12:32,560 --> 00:12:36,240
好那這邊可能牽涉到一些數學比較複雜的計算

308
00:12:36,240 --> 00:12:38,560
那我們可以講這個東西就好

309
00:12:38,560 --> 00:12:41,200
這個東西它其實是一個能量的函數

310
00:12:41,200 --> 00:12:42,400
一個能量式子

311
00:12:42,400 --> 00:12:46,320
那麼只要能讓這個能量有產生最小這個 f 的話呢

312
00:12:46,320 --> 00:12:48,960
我們找到這個 f 它就會是保角的

313
00:12:48,960 --> 00:12:51,200
就好像如果大家有聽過深度學習的話

314
00:12:51,200 --> 00:12:53,120
我們深度學習會去定一個 loss function

315
00:12:53,120 --> 00:12:55,360
那我們要想盡辦法去讓這個 loss function

316
00:12:55,440 --> 00:12:56,640
讓它慢慢下降

317
00:12:56,640 --> 00:12:57,440
那這也是一樣的

318
00:12:57,440 --> 00:12:58,720
我們去定一個能量函數

319
00:12:58,720 --> 00:13:00,960
然後讓這個能量函數變成是 0 的時候

320
00:13:00,960 --> 00:13:04,080
這時候的 f 就是保角的

321
00:13:04,080 --> 00:13:07,200
好那這裡的話其實就有相當多演算法

322
00:13:07,200 --> 00:13:09,280
那相當多演算法的話呢

323
00:13:09,280 --> 00:13:12,720
像我們實驗室就開發出兩種演算法

324
00:13:12,720 --> 00:13:15,440
好那我們這些演算法的話第一個就是說你要有效

325
00:13:15,440 --> 00:13:17,840
就是你按下去的話你要立刻就出來

326
00:13:17,840 --> 00:13:19,920
你不能說你按下去然後你等十分鐘

327
00:13:19,920 --> 00:13:21,040
都還沒出來

328
00:13:21,040 --> 00:13:23,520
就好比說你今天想要用它來做人臉辨識

329
00:13:23,600 --> 00:13:25,360
結果你站在門口五分鐘

330
00:13:25,360 --> 00:13:26,720
然後結果門都還沒打開

331
00:13:26,720 --> 00:13:27,840
這樣是不行的

332
00:13:27,840 --> 00:13:30,400
好那再來是說你今天你的這個存在性

333
00:13:30,400 --> 00:13:32,720
就是說我們正確的答案要藏在我們的算法裡面

334
00:13:32,720 --> 00:13:35,200
我們不能說我們的正確答案不在算法裡面

335
00:13:35,200 --> 00:13:36,400
好再來是收斂性

336
00:13:36,400 --> 00:13:39,920
收斂性的話是希望說我們的演算法能停止

337
00:13:39,920 --> 00:13:43,760
而且它的演算法停止的時候就是我們要的答案這樣

338
00:13:43,760 --> 00:13:45,520
好那我們剛剛講那麼多數學

339
00:13:45,520 --> 00:13:48,320
其實大家可以不用擔心說這些東西實做很困難

340
00:13:48,320 --> 00:13:50,400
這東西的話其實我們院美恆老師

341
00:13:50,400 --> 00:13:53,280
他其實有開發出一個 open source

342
00:13:53,280 --> 00:13:55,120
然後放在這個 MainLab 的網頁上

343
00:13:55,120 --> 00:13:56,880
所以大家可以去應用看看

344
00:13:56,880 --> 00:14:00,640
好那我們接下來就來講一下

345
00:14:00,640 --> 00:14:02,880
就是這個阿凡達他這個是怎麼做到的

346
00:14:02,880 --> 00:14:04,560
好那我們先來看喔

347
00:14:04,560 --> 00:14:06,960
這邊的話其實是一個三維的一個人臉

348
00:14:06,960 --> 00:14:08,080
人臉曲面

349
00:14:08,080 --> 00:14:11,040
然後右邊的話是一個貼紙

350
00:14:11,040 --> 00:14:12,320
大家可以想像是二維的

351
00:14:12,320 --> 00:14:13,520
那我這邊的話其實

352
00:14:13,520 --> 00:14:15,200
因為這個投屏幕就是平面的

353
00:14:15,200 --> 00:14:16,160
所以沒辦法表示出來

354
00:14:16,160 --> 00:14:18,880
如果待會有時間的話我會 demo 給大家看一下

355
00:14:18,880 --> 00:14:22,400
好那我們是怎麼做的呢

356
00:14:22,480 --> 00:14:24,640
我們剛剛有介紹過就是一個保角變換

357
00:14:24,640 --> 00:14:26,640
那我們透過一個保角變換的話

358
00:14:26,640 --> 00:14:28,160
先把它打到原盤上

359
00:14:28,160 --> 00:14:30,160
好那我們現在的話打到原盤上

360
00:14:30,160 --> 00:14:31,920
這邊是一個三維東西打到原盤上

361
00:14:31,920 --> 00:14:33,760
這邊是一個二維貼紙打到原盤上

362
00:14:33,760 --> 00:14:35,920
我們就可以在這個原盤上把它做配對

363
00:14:35,920 --> 00:14:38,320
好那我們配對的話我們叫做原盤註冊

364
00:14:38,320 --> 00:14:41,120
我們就可以把它這個點一一做配對

365
00:14:41,120 --> 00:14:42,160
好那配對之後的話

366
00:14:42,160 --> 00:14:43,680
我們透過剛剛的這個函數關係

367
00:14:43,680 --> 00:14:44,960
把它拉回去三維

368
00:14:44,960 --> 00:14:47,600
所以就可以得到一個三維的這個面具

369
00:14:47,600 --> 00:14:50,080
OK 好所以的話這兩個東西都是三維的

370
00:14:50,080 --> 00:14:51,600
然後這個是一個二維的東西

371
00:14:51,600 --> 00:14:54,160
所以我們就得到我們這個三維的這個面具

372
00:14:54,160 --> 00:14:57,360
好那這個東西就是它的成果這樣

373
00:14:57,360 --> 00:14:59,280
好那因為還有一點時間

374
00:14:59,280 --> 00:15:01,840
所以的話呢我怕大家說我在騙人

375
00:15:01,840 --> 00:15:03,280
就是它真的是三維的

376
00:15:03,280 --> 00:15:05,360
所以我就打開來檔案給大家看一下

377
00:15:05,360 --> 00:15:06,880
就是我們做完的這個結果

378
00:15:12,880 --> 00:15:13,840
好可能需要

379
00:15:13,840 --> 00:15:16,080
喔這個開 Metabox 需要一點時間

380
00:15:16,080 --> 00:15:17,120
那我們現在看好了

381
00:15:17,120 --> 00:15:20,160
就是這個貼紙它實際上就是一個二維的這個 png 檔案

382
00:15:20,880 --> 00:15:22,400
好然後呢這個

383
00:15:22,400 --> 00:15:25,680
好這個 Metabox 可能要啟動需要一點時間

384
00:15:25,680 --> 00:15:30,400
好那我們就接著先講下去

385
00:15:30,400 --> 00:15:39,360
好那接下來的話呢

386
00:15:39,360 --> 00:15:43,200
我想分享的是這個關於三維影像的這個幾何變換

387
00:15:43,200 --> 00:15:48,320
等一下喔

388
00:16:01,120 --> 00:16:04,960
APP 卡住了 sorry

389
00:16:04,960 --> 00:16:18,400
那接下來的話呢我先就是先分享一下就是我們在三維影像中我們是如何做到幾個變化

390
00:16:18,400 --> 00:16:25,920
那這個工作的話呢主要是由我們交大應數的這個 Jimmy Lab 還有這個陽明交通大學的這個秋成龍中心所主持的

391
00:16:25,920 --> 00:16:28,480
由我們老闆林文偉還有這個秋成龍教授

392
00:16:28,480 --> 00:16:35,280
好那我們其實遇到的問題是這樣的就是說我們今天醫學影像其實是一個非常龐大的一個資料

393
00:16:35,280 --> 00:16:37,680
可能有像是 MRI 還有 CT 影像

394
00:16:37,680 --> 00:16:43,200
好那像是這邊的話呢它的大小是由 240240 乘以 155 還有乘以 4 所組成的

395
00:16:43,200 --> 00:16:46,160
它的總點數的話呢大概有三千多萬點

396
00:16:46,160 --> 00:16:51,520
好那你把這個三千多萬點直接丟入電腦裡面它其實在 GPU 裡面呢是放不下

397
00:16:51,520 --> 00:16:55,680
大家應該知道 GPU 是什麼嘛 GPU 就是你們可能在玩遊戲的時候會用到的圖形顯示卡

398
00:16:55,840 --> 00:17:00,320
對但是我們在深度學習的時候呢我們會藉由這個 GPU 呢來幫助我們做加速

399
00:17:00,320 --> 00:17:04,320
那它這個速度落差有多大呢假設如果你今天不做 GPU 做訓練的話

400
00:17:04,320 --> 00:17:07,440
你可能要花的時間是一年可能非常非常久

401
00:17:07,440 --> 00:17:12,320
那如果你使用 GPU 的話呢可能就是可以在短短幾天甚至幾個禮拜就可以做完事情

402
00:17:12,320 --> 00:17:17,840
好那我們看到這個影像呢我們可以想像說腦其實就是在這個一小塊部分

403
00:17:17,840 --> 00:17:20,960
然後外面這影像其實都是空氣

404
00:17:20,960 --> 00:17:23,360
對就是它拍攝的時候呢會產生一些空氣這樣

405
00:17:23,360 --> 00:17:25,600
那這個紅色的話呢就是它的腫瘤

406
00:17:25,600 --> 00:17:30,000
那如果我們直接把它放進電腦裡面可能呢它一次沒辦法放很多顆

407
00:17:30,000 --> 00:17:32,640
所以我們想辦法說我們藉由一些幾何變換

408
00:17:32,640 --> 00:17:34,640
然後讓它可以放進電腦裡面

409
00:17:34,640 --> 00:17:38,720
好那想法是這樣的我們呢想辦法呢把它做一個壓縮

410
00:17:38,720 --> 00:17:43,840
就有點像是說你可能小時候呢看過田園圈可以變馬克杯這樣一個變換方式

411
00:17:43,840 --> 00:17:47,840
可是你今天現實生活中你把田園圈變馬克杯好像沒什麼用

412
00:17:47,840 --> 00:17:52,240
那如果今天我們把一個醫學影像腦影像呢變換成一個立方體的話

413
00:17:52,240 --> 00:17:56,080
而且這立方體的話呢它的大小是 128x128x128x4 這樣

414
00:17:56,080 --> 00:17:58,080
它大概點數變成是 800 多萬點

415
00:17:58,080 --> 00:18:00,480
它的整個壓縮率呢達到 76%

416
00:18:00,480 --> 00:18:03,280
這樣的話呢就可以有效的去節整它的空間這樣

417
00:18:03,280 --> 00:18:06,960
OK 所以我們把一個不規則的這個腦形狀呢變成是一個立方體

418
00:18:06,960 --> 00:18:10,160
然後就可以放入我們電腦裡面去做我們深度學習的訓練

419
00:18:10,160 --> 00:18:12,880
所以它有效達到這個植藥壓縮的這個效果

420
00:18:12,880 --> 00:18:16,320
那這個東西聽起來很理想它是怎麼樣做到的呢

421
00:18:16,320 --> 00:18:17,920
我們再來看一下

422
00:18:17,920 --> 00:18:20,480
它使用到一個技術叫做最後傳輸的這個技術

423
00:18:20,720 --> 00:18:22,560
那這個最後傳輸的技術大家可以呢

424
00:18:22,560 --> 00:18:24,400
去簡單的去理解這個式子就好了

425
00:18:24,400 --> 00:18:26,320
就是說我們原本空間的這個點呢

426
00:18:26,320 --> 00:18:29,520
它今天透過這個最後傳輸這個我們叫做 F

427
00:18:29,520 --> 00:18:31,920
它通過這個 F 映射之後呢跑到這個點上

428
00:18:31,920 --> 00:18:34,000
那我們希望說它這個映射的過程中呢

429
00:18:34,000 --> 00:18:36,160
它的這個差異要越小越好

430
00:18:36,160 --> 00:18:39,680
所以我們去計算說這個 V 減掉 FB 它的這個差異

431
00:18:39,680 --> 00:18:43,680
好那這邊的話呢可以想像是這個 ToNome 是長度意思

432
00:18:43,680 --> 00:18:47,280
我們希望說它們這個差異的長度呢要有最小值

433
00:18:47,280 --> 00:18:48,800
好那跟剛剛一樣

434
00:18:48,800 --> 00:18:52,080
我們希望說我們希望讓這個 C 產生最小 F

435
00:18:52,080 --> 00:18:55,200
而且呢這個 F 的話呢它是希望說它可以保體積的

436
00:18:55,200 --> 00:18:56,480
那為什麼要保體積呢

437
00:18:56,480 --> 00:18:59,200
大家可以想像是說我們希望腫瘤的地方

438
00:18:59,200 --> 00:19:00,400
可以被保持住嘛

439
00:19:00,400 --> 00:19:03,040
假如說如果你不幸的這個變換過程中呢

440
00:19:03,040 --> 00:19:04,560
你讓其他的區域放大了

441
00:19:04,560 --> 00:19:06,880
然後結果壓縮到腫瘤這個占比的話

442
00:19:06,880 --> 00:19:10,480
那這樣的話呢對你的生物學學習是不利的

443
00:19:10,480 --> 00:19:14,000
所以我們希望說這樣的 F 呢它是可以滿足保體積

444
00:19:14,000 --> 00:19:18,080
好那這裡的話呢我們要怎麼去讓這個能量越小呢

445
00:19:18,080 --> 00:19:20,480
大家如果學過就是深度學習的話

446
00:19:20,480 --> 00:19:23,040
大家也知道說我們最常用的方法就是這個叫做

447
00:19:23,040 --> 00:19:25,520
Gradient Descent 梯度下降法的方式

448
00:19:25,520 --> 00:19:27,360
好那這裡因為我們有提到說

449
00:19:27,360 --> 00:19:28,800
我們希望說它是保體積的

450
00:19:28,800 --> 00:19:30,960
所以的話這邊我們就多了一個名詞

451
00:19:30,960 --> 00:19:33,520
這個東西叫做投影梯度法的意思

452
00:19:33,520 --> 00:19:37,520
好那有機會的話我們再來介紹這個

453
00:19:37,520 --> 00:19:40,960
好那我們怎麼做用深度學習來做這個訓練呢

454
00:19:40,960 --> 00:19:43,520
首先的話呢這個東西是我們原始的腦影像

455
00:19:43,520 --> 00:19:45,680
那我們透過剛剛的這個技術叫 OMT

456
00:19:45,760 --> 00:19:49,680
我們把它轉換到一個 128x18x4 的這個立方體上

457
00:19:49,680 --> 00:19:53,520
那我們就把它這個東西丟入我們的模型裡面做訓練

458
00:19:53,520 --> 00:19:56,000
我們可以預測出來我們腫瘤這個部分

459
00:19:56,000 --> 00:19:57,840
好那預測出來腫瘤部分之後呢

460
00:19:57,840 --> 00:20:00,880
我們再把它透過這個 OMT 的反轉換

461
00:20:00,880 --> 00:20:02,320
變回原本的這個大腦裡面

462
00:20:02,320 --> 00:20:04,640
所以我們就可以得到我們預測出來的腫瘤

463
00:20:04,640 --> 00:20:07,920
好那整個過程中的話其實中間用到了深度學習

464
00:20:07,920 --> 00:20:12,640
那我們做 OMT 其實就是用它來做我們的前處理

465
00:20:12,640 --> 00:20:13,920
那最後的話我們結論就是說

466
00:20:14,000 --> 00:20:15,600
我們第一個就是我們在影像拼接上

467
00:20:15,600 --> 00:20:17,120
我們開發一個有效的算法

468
00:20:17,120 --> 00:20:19,760
然後並且可以完美的融合這個拼接

469
00:20:19,760 --> 00:20:22,480
那在速度上的話我們已經過了這個 Photoshop

470
00:20:22,480 --> 00:20:24,960
好然後再來說我們在曲面參數化的時候

471
00:20:24,960 --> 00:20:27,920
我們可以用把二維貼紙貼到一個三維曲面上

472
00:20:27,920 --> 00:20:30,560
做出類似阿凡達這種的應用

473
00:20:30,560 --> 00:20:32,800
好那最後一個就是說我們透過最後傳輸映射

474
00:20:32,800 --> 00:20:34,640
我們可以用它來壓縮資料

475
00:20:34,640 --> 00:20:37,120
然後結合 AI 進行訓練這樣

476
00:20:37,120 --> 00:20:39,120
那我的演講就到這裡 謝謝大家

477
00:20:43,920 --> 00:20:57,280
請不吝點贊訂閱轉發打賞支持明鏡與點點欄目


